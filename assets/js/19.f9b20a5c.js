(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{332:function(s,n,a){"use strict";a.r(n);var t=a(7),e=Object(t.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h4",{attrs:{id:"linux下安装rsync"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#linux下安装rsync"}},[s._v("#")]),s._v(" linux下安装rsync")]),s._v(" "),n("p",[s._v("这里使用了rsync作为数据同步的工具，首先需要在linux主机下安装rsync，\n参考你的linux发行版去搜一下怎么装rsync，基本一条命令的事。")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("yum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--version")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/poshangqiucao/BlogPictures/pictures/2022-11-23_09-12-37.png",alt:"2022-11-23_09-12-37"}})]),s._v(" "),n("h4",{attrs:{id:"接下来配置一下linux下的rsync"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#接下来配置一下linux下的rsync"}},[s._v("#")]),s._v(" 接下来配置一下linux下的rsync")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/rsyncd.conf\n\n配置文件内容\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /etc/rsyncd: configuration file for rsync daemon mode")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# See rsyncd.conf man page for more options.")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# configuration example:")]),s._v("\nuid "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" root\ngid "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" root\nuse "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chroot")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" no\nmax connections "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\npid "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /var/run/rsyncd.pid\nlog "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /var/log/rsyncd.log\nlock "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /var/run/rsyncd.lock\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\npath "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /mnt/file\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" only "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" no\nauth "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("users")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v("\nsecrets "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /etc/rsyncd.secrets\nlist "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" no\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("p",[s._v("这里的secrets file文件是配置客户端连接服务端rsync的用户名密码\n文件里以"),n("code",[s._v("用户名:密码")]),s._v("的格式一行一个就可以了。\n配置完成后使用命令启动rsync就可以了。"),n("code",[s._v("rsync --daemon")]),s._v("\n还有注意放开端口873")]),s._v(" "),n("h4",{attrs:{id:"windows下安装rsync"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#windows下安装rsync"}},[s._v("#")]),s._v(" windows下安装rsync")]),s._v(" "),n("p",[s._v("这里使用rsync在windows下的版本cwAsync,"),n("a",{attrs:{href:"https://www.itefix.net/cwrsync",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.itefix.net/cwrsync"),n("OutboundLink")],1),s._v(",\n下载后放到某一目录下，配置一下环境变量。")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--port")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("873")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-av")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--progress")]),s._v(" --password-file"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/cygdrive/d/test.password /cygdrive/e/test_projects/目录名 rsync@192.168.1.1::上面配置的xx模块名\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("test.password文件里只存一下密码就可以了。"),n("br"),s._v("\nrsync只会同步发生变化的文件，效率还是比较高的。")]),s._v(" "),n("h4",{attrs:{id:"mysql数据库备份bat脚本"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mysql数据库备份bat脚本"}},[s._v("#")]),s._v(" mysql数据库备份bat脚本")]),s._v(" "),n("div",{staticClass:"language-bat line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('@echo off\n\n\necho 设置MySql数据库的连接信息\nset host=127.0.0.1\nset port=xx\nset user=xx\nset pass=xx\n\necho 设置要备份MySql数据库名称\nset dbname=xx\n\necho 获取当天的日期格式，例如：20200902231300\nset hour=%time:~0,2%\nif "%time:~0,1%"==" " set hour=0%time:~1,1%\n\nset backup_date=%Date:~0,4%%Date:~5,2%%Date:~8,2%%hour%%Time:~3,2%%Time:~6,2%\n\necho 设置备份文件的路径\nset backupfile=xx\\%dbname%-%backup_date%.sql\n\n\necho 使用mysqldump对指定的MySql进行备份\necho 注意路径中有空格的要加上双引号\n\n"C:\\Program Files\\MySQL\\MySQL Server 5.7\\bin\\mysqldump" -h%host% -P%port% -u%user% -p%pass% -c --add-drop-table %dbname% > %backupfile%\n\necho 删除过期文件，这里是超过30天就删除\n\nforfiles /p 文件路径 /s /m *.sql /d -30 /c "cmd /c del @file /f"\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br")])]),n("p",[s._v("这个mysql数据库备份脚本在windows下设置一下定时任务就可以了。")]),s._v(" "),n("h4",{attrs:{id:"redis中rdb文件的备份"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#redis中rdb文件的备份"}},[s._v("#")]),s._v(" redis中rdb文件的备份")]),s._v(" "),n("p",[s._v("使用上面的同步命令就可以了 同步rdb文件到远程linux机器。")]),s._v(" "),n("h4",{attrs:{id:"备份效果"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#备份效果"}},[s._v("#")]),s._v(" 备份效果")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/poshangqiucao/BlogPictures/pictures/2022-11-23_09-39-19.png",alt:"2022-11-23_09-39-19"}})]),s._v(" "),n("h4",{attrs:{id:"放张图片休息一下"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#放张图片休息一下"}},[s._v("#")]),s._v(" 放张图片休息一下")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/poshangqiucao/BlogPictures/pictures/202211230957820.jpg",alt:"xx"}})])])}),[],!1,null,null,null);n.default=e.exports}}]);